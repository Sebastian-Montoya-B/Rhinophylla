#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
dev.off()
source("~/GitHub/Rhinophylla/Figure 1.R")
segments(x0=0.5, x1=25.5, y0=23, y1=23, xpd=TRUE)
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(6,8,2,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=23, y1=23, xpd=TRUE)
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=23, y1=23, xpd=TRUE)
dev.off()
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=21, y1=21, xpd=TRUE)
dev.off()
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=21, y1=21, xpd=TRUE)
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=22, y1=22, xpd=TRUE)
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,25.5), x1=c(0.5,25.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,25.5), x1=c(0.5,25.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.05, labels="Consumption events", xpd=TRUE, col="#6B9814")
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,25.5), x1=c(0.5,25.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events"), xpd=TRUE, col="#6B9814")
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,25.5), x1=c(0.5,25.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events")), xpd=TRUE, col="#6B9814")
dev.off()
source("~/GitHub/Rhinophylla/Figure 1.R")
dev.off()
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
#plotmatrix(rhin.mat[c(2,1,6,4,7,9,5,11,8,10,12,13,14,3),c(12,7,1,10,2,4,8,9,11,14,15,6,13,16,3,5)],
#           plot_labels=TRUE,
#           binary=FALSE)
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 16.5),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*", 3 ,9,8,"*",3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,25), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,25), x1=c(1,2,3,7,8,25), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=25.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,25.5), x1=c(0.5,25.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events")), xpd=TRUE, col="#6B9814")
dev.off()
library(tidyverse)
data<-read.csv("Rhinophylla.csv", sep=",")
data[data$bat=="Rhinophylla alethina",]
prop<-c()
for (i in 1:nrow(data)){
prop[i]<-data$N[i]/sum(data$N[data$Site==data$Site[i]])
}
data$prop<-prop
data
data<-data[-which(data$Fam=="Unknown"),]
rhin.mat<-reshape(data[,c("Fam","Site","prop")], direction="wide", idvar= "Fam", timevar="Site")
row.names(rhin.mat)<-rhin.mat$Fam
rhin.mat<-rhin.mat[,-1]
rhin.mat[is.na(rhin.mat)]<-0
rhin.mat<-as.matrix(rhin.mat)
inorder<-colnames(rhin.mat)
colnames(rhin.mat)<-c(rep("R. alethina",2), rep("R. fischerae",5), rep("R. pumilio",18))
rhin.mat2<-rhin.mat
rhin.mat2[rhin.mat2 >0]<-1
v<-rowSums(rhin.mat2)
sorted <- order(-v, names(v))
rhin.mat<-rhin.mat[sorted,]
par(las=1, mar=c(4,8,4,1))
plotmatrix(rhin.mat,
plot_labels=TRUE,
binary=FALSE, base_color="#6B9814")
library(bipartite)
plotmatrix(rhin.mat,
plot_labels=TRUE,
binary=FALSE, base_color="#6B9814")
View(rhin.mat)
rhin.mat[,19]
data<-read.csv("Rhinophylla.csv", sep=",")
data[data$bat=="Rhinophylla alethina",]
prop<-c()
for (i in 1:nrow(data)){
prop[i]<-data$N[i]/sum(data$N[data$Site==data$Site[i]])
}
data$prop<-prop
data
data[,c("Site", "ref")]
data[,c("Site", "Ref")]
data[,c("Site", "Ref")] %>% unique
data[,c("Site", "Ref")] %>% unique %>% length
data[,c("Site", "Ref")] %>% unique %>% nrow
data<-data[-which(data$Fam=="Unknown"),]
rhin.mat<-reshape(data[,c("Fam","Site","prop")], direction="wide", idvar= "Fam", timevar="Site")
row.names(rhin.mat)<-rhin.mat$Fam
rhin.mat<-rhin.mat[,-1]
rhin.mat[is.na(rhin.mat)]<-0
rhin.mat<-as.matrix(rhin.mat)
inorder<-colnames(rhin.mat)
colnames(rhin.mat)<-c(rep("R. alethina",2), rep("R. fischerae",5), rep("R. pumilio",18))
rhin.mat2<-rhin.mat
rhin.mat2[rhin.mat2 >0]<-1
v<-rowSums(rhin.mat2)
sorted <- order(-v, names(v))
rhin.mat<-rhin.mat[sorted,]
rhin.mat
data<-data[-which(data$Fam=="Unknown"),]
rhin.mat<-reshape(data[,c("Fam","Site","prop")], direction="wide", idvar= "Fam", timevar="Site")
row.names(rhin.mat)<-rhin.mat$Fam
rhin.mat<-rhin.mat[,-1]
rhin.mat[is.na(rhin.mat)]<-0
rhin.mat<-as.matrix(rhin.mat)
inorder<-colnames(rhin.mat)
colnames(rhin.mat)
rhin.mat
data<-read.csv("Rhinophylla.csv", sep=",")
data[data$bat=="Rhinophylla alethina",]
prop<-c()
for (i in 1:nrow(data)){
prop[i]<-data$N[i]/sum(data$N[data$Site==data$Site[i]])
}
data$prop<-prop
data[,c("Site", "Ref")] %>% unique %>% nrow
data
data<-data[-which(data$Fam=="Unknown"),]
rhin.mat<-reshape(data[,c("Fam","Site","prop")], direction="wide", idvar= "Fam", timevar="Site")
row.names(rhin.mat)<-rhin.mat$Fam
rhin.mat<-rhin.mat[,-1]
rhin.mat[is.na(rhin.mat)]<-0
rhin.mat<-as.matrix(rhin.mat)
inorder<-colnames(rhin.mat)
colnames(rhin.mat)
data[,c("Site", "Ref")] %>% unique %>% nrow
data[,c("Site", "Ref")] %>% unique
N<-c(31,"*",
3 ,9,8,"*","*",
3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
length(N)
data[,c("Site", "Ref")] %>% unique %>% nrow
data<-read.csv("Rhinophylla.csv", sep=",")
data[data$bat=="Rhinophylla alethina",]
data[,c("Site", "Ref")] %>% unique %>% nrow
data
data[,c("Site", "Ref")] %>% unique
data[,c("bat", "Site", "Ref")] %>% unique %>% nrow
data
data[,c("bat", "Site", "Ref")] %>% unique %>% nrow
data$batcode<-paste0(data$bat, data$Site)
rhin.mat<-reshape(data[,c("batcode","Site","prop")], direction="wide", idvar= "Fam", timevar="Site")
row.names(rhin.mat)<-rhin.mat$Fam
rhin.mat<-reshape(data[,c("Fam","batcode","prop")], direction="wide", idvar= "Fam", timevar="batcode")
data$batcode
data[,c("Fam","batcode","prop")]
data<-read.csv("Rhinophylla.csv", sep=",")
data[data$bat=="Rhinophylla alethina",]
prop<-c()
for (i in 1:nrow(data)){
prop[i]<-data$N[i]/sum(data$N[data$Site==data$Site[i]])
}
data$prop<-prop
data[,c("bat", "Site", "Ref")] %>% unique %>% nrow
data
data<-data[-which(data$Fam=="Unknown"),]
data$batcode<-paste0(data$bat, data$Site)
rhin.mat<-reshape(data[,c("Fam","batcode","prop")], direction="wide", idvar= "Fam", timevar="batcode")
row.names(rhin.mat)<-rhin.mat$Fam
rhin.mat<-rhin.mat[,-1]
rhin.mat[is.na(rhin.mat)]<-0
rhin.mat<-as.matrix(rhin.mat)
inorder<-colnames(rhin.mat)
colnames(rhin.mat)<-c(rep("R. alethina",2), rep("R. fischerae",5), rep("R. pumilio",19))
data[,c("bat", "Site", "Ref")] %>% unique
batnames<-unique(data[,c("bat", "Site", "Ref")])$bat
batnames
data
source("~/GitHub/Rhinophylla/Figure 1.R")
colnames(rhin.mat)<-batnames
rhin.mat2<-rhin.mat
rhin.mat2[rhin.mat2 >0]<-1
v<-rowSums(rhin.mat2)
sorted <- order(-v, names(v))
rhin.mat<-rhin.mat[sorted,]
library(bipartite)
par(las=1, mar=c(4,8,4,1))
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 17),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*",
3 ,9,8,"*","*",
3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,26), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,26), x1=c(1,2,3,7,8,26), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=26.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,26.5), x1=c(0.5,25.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events")), xpd=TRUE, col="#6B9814")
source("~/GitHub/Rhinophylla/Figure 1.R")
png(filename="Figures1.png", width=5000, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 17),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*",
3 ,9,8,"*","*",
3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,26), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,26), x1=c(1,2,3,7,8,26), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=26.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,26.5), x1=c(0.5,26.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events")), xpd=TRUE, col="#6B9814")
dev.off()
png(filename="Figures1.png", width=5200, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 17),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*",
3 ,9,8,"*","*",
3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,26), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,26), x1=c(1,2,3,7,8,26), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=26.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,26.5), x1=c(0.5,26.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events")), xpd=TRUE, col="#6B9814")
dev.off()
source("~/GitHub/Rhinophylla/Figure 1.R")
source("~/GitHub/Rhinophylla/Figure 1.R")
unique(data$Ref)
19-5
source("~/GitHub/Rhinophylla/Figure 1.R")
png(filename="Fig 2.png", width=5200, height=3600, res=600)
par(las=1, mar=c(4,8,4,1))
plotmatrix(rhin.mat,
plot_labels=FALSE,
binary=FALSE, base_color="#6B9814")
axis(1, at= 1:31, cex.axis=0.8, mgp=c(2,0,0), tick=FALSE)
mtext(text=c(expression(italic("R. alethina"),
italic("R. fischerae"),
italic("R. pumilio"))),
side=1, at = c(1.2,5, 17),line=2, cex=0.9)
axis(2, at = 1:nrow(rhin.mat),
labels =rownames(rhin.mat)[length(rownames(rhin.mat)):1],cex.axis=0.9,
mgp=c(2,0.5,0), tick=FALSE)
N<-c(31,"*",
3 ,9,8,"*","*",
3,53,35,38,6,8,5,12,5,17,24,4,1,"*",
3,"*",5,17,"*")
axis(3, at=1:ncol(rhin.mat),labels=N, tick=F, las=1, cex.axis=0.8,mgp=c(2,0,0))
abline(v=c(2.5, 7.5), lty=2)
segments(x0=c(1,3,8), x1=c(2,7,26), y0=-1, y1=-1, xpd=TRUE)
segments(x0=c(1,2,3,7,8,26), x1=c(1,2,3,7,8,26), y0=rep(-1,6), y1=rep(-0.5,6), xpd=TRUE)
segments(x0=0.5, x1=26.5, y0=22, y1=22, xpd=TRUE)
segments(x0=c(0.5,26.5), x1=c(0.5,26.5), y0=c(22,22), y1=c(21.5,21.5), xpd=TRUE)
text(x=12, y= 22.5, labels=expression(bold("Consumption events")), xpd=TRUE, col="#6B9814")
dev.off()
